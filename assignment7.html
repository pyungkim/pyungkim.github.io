<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Pyung Kim - Assignment 7</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Pyung Kim</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html">About</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./research.html">Research</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./project.html">Project</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./cv.pdf">CV</a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-assignment" role="button" data-bs-toggle="dropdown" aria-expanded="false">Assignment</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-assignment">    
        <li>
    <a class="dropdown-item" href="./Final.html">
 <span class="dropdown-text">Final Project</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assignment1.html">
 <span class="dropdown-text">Assignment 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assignment2.html">
 <span class="dropdown-text">Assignment 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assignment3.html">
 <span class="dropdown-text">Assignment 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assignment4.html">
 <span class="dropdown-text">Assignment 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assignment5.html">
 <span class="dropdown-text">Assignment 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assignment6.html">
 <span class="dropdown-text">Assignment 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assignment7.html">
 <span class="dropdown-text">Assignment 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assignment8.html">
 <span class="dropdown-text">Assignment 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assignment9.html">
 <span class="dropdown-text">Assignment 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./assignment10.html">
 <span class="dropdown-text">Assignment 8</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://pyungkim.github.io/pkimblog.github.io/">Blog</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Assignment 7</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>Assignment 7</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())                          <span class="co"># Clear environment</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fmsb)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridBase)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: viridisLite</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>library</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (package, help, pos = 2, lib.loc = NULL, character.only = FALSE, 
    logical.return = FALSE, warn.conflicts, quietly = FALSE, 
    verbose = getOption("verbose"), mask.ok, exclude, include.only, 
    attach.required = missing(include.only)) 
{
    conf.ctrl &lt;- getOption("conflicts.policy")
    if (is.character(conf.ctrl)) 
        conf.ctrl &lt;- switch(conf.ctrl, strict = list(error = TRUE, 
            warn = FALSE), depends.ok = list(error = TRUE, generics.ok = TRUE, 
            can.mask = c("base", "methods", "utils", "grDevices", 
                "graphics", "stats"), depends.ok = TRUE), warning(gettextf("unknown conflict policy: %s", 
            sQuote(conf.ctrl)), call. = FALSE, domain = NA))
    if (!is.list(conf.ctrl)) 
        conf.ctrl &lt;- NULL
    stopOnConflict &lt;- isTRUE(conf.ctrl$error)
    if (missing(warn.conflicts)) 
        warn.conflicts &lt;- !isFALSE(conf.ctrl$warn)
    if (!missing(include.only) &amp;&amp; !missing(exclude)) 
        stop("only one of 'include.only' and 'exclude' can be used", 
            call. = FALSE)
    testRversion &lt;- function(pkgInfo, pkgname, pkgpath) {
        if (is.null(built &lt;- pkgInfo$Built)) 
            stop(gettextf("package %s has not been installed properly\n", 
                sQuote(pkgname)), call. = FALSE, domain = NA)
        R_version_built_under &lt;- as.numeric_version(built$R)
        if (R_version_built_under &lt; "3.0.0") 
            stop(gettextf("package %s was built before R 3.0.0: please re-install it", 
                sQuote(pkgname)), call. = FALSE, domain = NA)
        current &lt;- getRversion()
        if (length(Rdeps &lt;- pkgInfo$Rdepends2)) {
            for (dep in Rdeps) if (length(dep) &gt; 1L) {
                target &lt;- dep$version
                res &lt;- do.call(dep$op, if (is.character(target)) 
                  list(as.numeric(R.version[["svn rev"]]), as.numeric(sub("^r", 
                    "", target)))
                else list(current, as.numeric_version(target)))
                if (!res) 
                  stop(gettextf("This is R %s, package %s needs %s %s", 
                    current, sQuote(pkgname), dep$op, target), 
                    call. = FALSE, domain = NA)
            }
        }
        if (R_version_built_under &gt; current) 
            warning(gettextf("package %s was built under R version %s", 
                sQuote(pkgname), as.character(built$R)), call. = FALSE, 
                domain = NA)
        platform &lt;- built$Platform
        r_arch &lt;- .Platform$r_arch
        if (.Platform$OS.type == "unix") {
        }
        else {
            if (nzchar(platform) &amp;&amp; !grepl("mingw", platform)) 
                stop(gettextf("package %s was built for %s", 
                  sQuote(pkgname), platform), call. = FALSE, 
                  domain = NA)
        }
        if (nzchar(r_arch) &amp;&amp; file.exists(file.path(pkgpath, 
            "libs")) &amp;&amp; !file.exists(file.path(pkgpath, "libs", 
            r_arch))) 
            stop(gettextf("package %s is not installed for 'arch = %s'", 
                sQuote(pkgname), r_arch), call. = FALSE, domain = NA)
    }
    checkNoGenerics &lt;- function(env, pkg) {
        nenv &lt;- env
        ns &lt;- .getNamespace(as.name(pkg))
        if (!is.null(ns)) 
            nenv &lt;- asNamespace(ns)
        if (exists(".noGenerics", envir = nenv, inherits = FALSE)) 
            TRUE
        else {
            !any(startsWith(names(env), ".__T"))
        }
    }
    checkConflicts &lt;- function(package, pkgname, pkgpath, nogenerics, 
        env) {
        dont.mind &lt;- c("last.dump", "last.warning", ".Last.value", 
            ".Random.seed", ".Last.lib", ".onDetach", ".packageName", 
            ".noGenerics", ".required", ".no_S3_generics", ".Depends", 
            ".requireCachedGenerics")
        sp &lt;- search()
        lib.pos &lt;- which(sp == pkgname)
        ob &lt;- names(as.environment(lib.pos))
        if (!nogenerics) {
            these &lt;- ob[startsWith(ob, ".__T__")]
            gen &lt;- gsub(".__T__(.*):([^:]+)", "\\1", these)
            from &lt;- gsub(".__T__(.*):([^:]+)", "\\2", these)
            gen &lt;- gen[from != package]
            ob &lt;- ob[!(ob %in% gen)]
        }
        ipos &lt;- seq_along(sp)[-c(lib.pos, match(c("Autoloads", 
            "CheckExEnv"), sp, 0L))]
        cpos &lt;- NULL
        conflicts &lt;- vector("list", 0)
        for (i in ipos) {
            obj.same &lt;- match(names(as.environment(i)), ob, nomatch = 0L)
            if (any(obj.same &gt; 0L)) {
                same &lt;- ob[obj.same]
                same &lt;- same[!(same %in% dont.mind)]
                Classobjs &lt;- which(startsWith(same, ".__"))
                if (length(Classobjs)) 
                  same &lt;- same[-Classobjs]
                same.isFn &lt;- function(where) vapply(same, exists, 
                  NA, where = where, mode = "function", inherits = FALSE)
                same &lt;- same[same.isFn(i) == same.isFn(lib.pos)]
                not.Ident &lt;- function(ch, TRAFO = identity, ...) vapply(ch, 
                  function(.) !identical(TRAFO(get(., i)), TRAFO(get(., 
                    lib.pos)), ...), NA)
                if (length(same)) 
                  same &lt;- same[not.Ident(same)]
                if (length(same) &amp;&amp; identical(sp[i], "package:base")) 
                  same &lt;- same[not.Ident(same, ignore.environment = TRUE)]
                if (length(same)) {
                  conflicts[[sp[i]]] &lt;- same
                  cpos[sp[i]] &lt;- i
                }
            }
        }
        if (length(conflicts)) {
            if (stopOnConflict) {
                emsg &lt;- ""
                pkg &lt;- names(conflicts)
                notOK &lt;- vector("list", 0)
                for (i in seq_along(conflicts)) {
                  pkgname &lt;- sub("^package:", "", pkg[i])
                  if (pkgname %in% canMaskEnv$canMask) 
                    next
                  same &lt;- conflicts[[i]]
                  if (is.list(mask.ok)) 
                    myMaskOK &lt;- mask.ok[[pkgname]]
                  else myMaskOK &lt;- mask.ok
                  if (isTRUE(myMaskOK)) 
                    same &lt;- NULL
                  else if (is.character(myMaskOK)) 
                    same &lt;- setdiff(same, myMaskOK)
                  if (length(same)) {
                    notOK[[pkg[i]]] &lt;- same
                    msg &lt;- .maskedMsg(sort(same), pkg = sQuote(pkg[i]), 
                      by = cpos[i] &lt; lib.pos)
                    emsg &lt;- paste(emsg, msg, sep = "\n")
                  }
                }
                if (length(notOK)) {
                  msg &lt;- gettextf("Conflicts attaching package %s:\n%s", 
                    sQuote(package), emsg)
                  stop(errorCondition(msg, package = package, 
                    conflicts = conflicts, class = "packageConflictError"))
                }
            }
            if (warn.conflicts) {
                packageStartupMessage(gettextf("\nAttaching package: %s\n", 
                  sQuote(package)), domain = NA)
                pkg &lt;- names(conflicts)
                for (i in seq_along(conflicts)) {
                  msg &lt;- .maskedMsg(sort(conflicts[[i]]), pkg = sQuote(pkg[i]), 
                    by = cpos[i] &lt; lib.pos)
                  packageStartupMessage(msg, domain = NA)
                }
            }
        }
    }
    if (verbose &amp;&amp; quietly) 
        message("'verbose' and 'quietly' are both true; being verbose then ..")
    if (!missing(package)) {
        if (is.null(lib.loc)) 
            lib.loc &lt;- .libPaths()
        lib.loc &lt;- lib.loc[dir.exists(lib.loc)]
        if (!character.only) 
            package &lt;- as.character(substitute(package))
        if (length(package) != 1L) 
            stop("'package' must be of length 1")
        if (is.na(package) || (package == "")) 
            stop("invalid package name")
        pkgname &lt;- paste0("package:", package)
        newpackage &lt;- is.na(match(pkgname, search()))
        if (newpackage) {
            pkgpath &lt;- find.package(package, lib.loc, quiet = TRUE, 
                verbose = verbose)
            if (length(pkgpath) == 0L) {
                if (length(lib.loc) &amp;&amp; !logical.return) 
                  stop(packageNotFoundError(package, lib.loc, 
                    sys.call()))
                txt &lt;- if (length(lib.loc)) 
                  gettextf("there is no package called %s", sQuote(package))
                else gettext("no library trees found in 'lib.loc'")
                if (logical.return) {
                  if (!quietly) 
                    warning(txt, domain = NA)
                  return(FALSE)
                }
                else stop(txt, domain = NA)
            }
            which.lib.loc &lt;- normalizePath(dirname(pkgpath), 
                "/", TRUE)
            pfile &lt;- system.file("Meta", "package.rds", package = package, 
                lib.loc = which.lib.loc)
            if (!nzchar(pfile)) 
                stop(gettextf("%s is not a valid installed package", 
                  sQuote(package)), domain = NA)
            pkgInfo &lt;- readRDS(pfile)
            testRversion(pkgInfo, package, pkgpath)
            if (is.character(pos)) {
                npos &lt;- match(pos, search())
                if (is.na(npos)) {
                  warning(gettextf("%s not found on search path, using pos = 2", 
                    sQuote(pos)), domain = NA)
                  pos &lt;- 2
                }
                else pos &lt;- npos
            }
            deps &lt;- unique(names(pkgInfo$Depends))
            depsOK &lt;- isTRUE(conf.ctrl$depends.ok)
            if (depsOK) {
                canMaskEnv &lt;- dynGet("__library_can_mask__", 
                  NULL)
                if (is.null(canMaskEnv)) {
                  canMaskEnv &lt;- new.env()
                  canMaskEnv$canMask &lt;- union("base", conf.ctrl$can.mask)
                  "__library_can_mask__" &lt;- canMaskEnv
                }
                canMaskEnv$canMask &lt;- unique(c(package, deps, 
                  canMaskEnv$canMask))
            }
            else canMaskEnv &lt;- NULL
            if (attach.required) 
                .getRequiredPackages2(pkgInfo, quietly = quietly)
            cr &lt;- conflictRules(package)
            if (missing(mask.ok)) 
                mask.ok &lt;- cr$mask.ok
            if (missing(exclude)) 
                exclude &lt;- cr$exclude
            if (packageHasNamespace(package, which.lib.loc)) {
                if (isNamespaceLoaded(package)) {
                  newversion &lt;- as.numeric_version(pkgInfo$DESCRIPTION["Version"])
                  oldversion &lt;- as.numeric_version(getNamespaceVersion(package))
                  if (newversion != oldversion) {
                    tryCatch(unloadNamespace(package), error = function(e) {
                      P &lt;- if (!is.null(cc &lt;- conditionCall(e))) 
                        paste("Error in", deparse(cc)[1L], ": ")
                      else "Error : "
                      stop(gettextf("Package %s version %s cannot be unloaded:\n %s", 
                        sQuote(package), oldversion, paste0(P, 
                          conditionMessage(e), "\n")), domain = NA)
                    })
                  }
                }
                tt &lt;- tryCatch({
                  attr(package, "LibPath") &lt;- which.lib.loc
                  ns &lt;- loadNamespace(package, lib.loc)
                  env &lt;- attachNamespace(ns, pos = pos, deps, 
                    exclude, include.only)
                }, error = function(e) {
                  P &lt;- if (!is.null(cc &lt;- conditionCall(e))) 
                    paste(" in", deparse(cc)[1L])
                  else ""
                  msg &lt;- gettextf("package or namespace load failed for %s%s:\n %s", 
                    sQuote(package), P, conditionMessage(e))
                  if (logical.return &amp;&amp; !quietly) 
                    message(paste("Error:", msg), domain = NA)
                  else stop(msg, call. = FALSE, domain = NA)
                })
                if (logical.return &amp;&amp; is.null(tt)) 
                  return(FALSE)
                attr(package, "LibPath") &lt;- NULL
                {
                  on.exit(detach(pos = pos))
                  nogenerics &lt;- !.isMethodsDispatchOn() || checkNoGenerics(env, 
                    package)
                  if (isFALSE(conf.ctrl$generics.ok) || (stopOnConflict &amp;&amp; 
                    !isTRUE(conf.ctrl$generics.ok))) 
                    nogenerics &lt;- TRUE
                  if (stopOnConflict || (warn.conflicts &amp;&amp; !exists(".conflicts.OK", 
                    envir = env, inherits = FALSE))) 
                    checkConflicts(package, pkgname, pkgpath, 
                      nogenerics, ns)
                  on.exit()
                  if (logical.return) 
                    return(TRUE)
                  else return(invisible(.packages()))
                }
            }
            else stop(gettextf("package %s does not have a namespace and should be re-installed", 
                sQuote(package)), domain = NA)
        }
        if (verbose &amp;&amp; !newpackage) 
            warning(gettextf("package %s already present in search()", 
                sQuote(package)), domain = NA)
    }
    else if (!missing(help)) {
        if (!character.only) 
            help &lt;- as.character(substitute(help))
        pkgName &lt;- help[1L]
        pkgPath &lt;- find.package(pkgName, lib.loc, verbose = verbose)
        docFiles &lt;- c(file.path(pkgPath, "Meta", "package.rds"), 
            file.path(pkgPath, "INDEX"))
        if (file.exists(vignetteIndexRDS &lt;- file.path(pkgPath, 
            "Meta", "vignette.rds"))) 
            docFiles &lt;- c(docFiles, vignetteIndexRDS)
        pkgInfo &lt;- vector("list", 3L)
        readDocFile &lt;- function(f) {
            if (basename(f) %in% "package.rds") {
                txt &lt;- readRDS(f)$DESCRIPTION
                if ("Encoding" %in% names(txt)) {
                  to &lt;- if (Sys.getlocale("LC_CTYPE") == "C") 
                    "ASCII//TRANSLIT"
                  else ""
                  tmp &lt;- try(iconv(txt, from = txt["Encoding"], 
                    to = to))
                  if (!inherits(tmp, "try-error")) 
                    txt &lt;- tmp
                  else warning("'DESCRIPTION' has an 'Encoding' field and re-encoding is not possible", 
                    call. = FALSE)
                }
                nm &lt;- paste0(names(txt), ":")
                formatDL(nm, txt, indent = max(nchar(nm, "w")) + 
                  3L)
            }
            else if (basename(f) %in% "vignette.rds") {
                txt &lt;- readRDS(f)
                if (is.data.frame(txt) &amp;&amp; nrow(txt)) 
                  cbind(basename(gsub("\\.[[:alpha:]]+$", "", 
                    txt$File)), paste(txt$Title, paste0(rep.int("(source", 
                    NROW(txt)), ifelse(nzchar(txt$PDF), ", pdf", 
                    ""), ")")))
                else NULL
            }
            else readLines(f)
        }
        for (i in which(file.exists(docFiles))) pkgInfo[[i]] &lt;- readDocFile(docFiles[i])
        y &lt;- list(name = pkgName, path = pkgPath, info = pkgInfo)
        class(y) &lt;- "packageInfo"
        return(y)
    }
    else {
        if (is.null(lib.loc)) 
            lib.loc &lt;- .libPaths()
        db &lt;- matrix(character(), nrow = 0L, ncol = 3L)
        nopkgs &lt;- character()
        for (lib in lib.loc) {
            a &lt;- .packages(all.available = TRUE, lib.loc = lib)
            for (i in sort(a)) {
                file &lt;- system.file("Meta", "package.rds", package = i, 
                  lib.loc = lib)
                title &lt;- if (nzchar(file)) {
                  txt &lt;- readRDS(file)
                  if (is.list(txt)) 
                    txt &lt;- txt$DESCRIPTION
                  if ("Encoding" %in% names(txt)) {
                    to &lt;- if (Sys.getlocale("LC_CTYPE") == "C") 
                      "ASCII//TRANSLIT"
                    else ""
                    tmp &lt;- try(iconv(txt, txt["Encoding"], to, 
                      "?"))
                    if (!inherits(tmp, "try-error")) 
                      txt &lt;- tmp
                    else warning("'DESCRIPTION' has an 'Encoding' field and re-encoding is not possible", 
                      call. = FALSE)
                  }
                  txt["Title"]
                }
                else NA
                if (is.na(title)) 
                  title &lt;- " ** No title available ** "
                db &lt;- rbind(db, cbind(i, lib, title))
            }
            if (length(a) == 0L) 
                nopkgs &lt;- c(nopkgs, lib)
        }
        dimnames(db) &lt;- list(NULL, c("Package", "LibPath", "Title"))
        if (length(nopkgs) &amp;&amp; !missing(lib.loc)) {
            pkglist &lt;- paste(sQuote(nopkgs), collapse = ", ")
            msg &lt;- sprintf(ngettext(length(nopkgs), "library %s contains no packages", 
                "libraries %s contain no packages"), pkglist)
            warning(msg, domain = NA)
        }
        y &lt;- list(header = NULL, results = db, footer = NULL)
        class(y) &lt;- "libraryIQR"
        return(y)
    }
    if (logical.return) 
        TRUE
    else invisible(.packages())
}
&lt;bytecode: 0x130163a58&gt;
&lt;environment: namespace:base&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>descriptive<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">"descriptive_stat.xlsx"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>provincedata<span class="ot">&lt;-</span><span class="fu">read_excel</span>(<span class="st">"province.xlsx"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">barplot</span>(descriptive<span class="sc">$</span>total_pollutants, <span class="at">names.arg =</span>descriptive<span class="sc">$</span>year, <span class="at">main =</span> <span class="st">"Total amount of pollutants"</span>,<span class="at">col=</span><span class="st">"lightcyan"</span>,<span class="at">cex.names=</span><span class="fl">0.7</span>,)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span>bp, <span class="at">y=</span>descriptive<span class="sc">$</span>total_pollutants<span class="sc">*</span><span class="fl">0.9</span>,<span class="at">labels =</span> descriptive<span class="sc">$</span>total_pollutants,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">cex=</span><span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="assignment7_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>bp1 <span class="ot">&lt;-</span> <span class="fu">barplot</span>(descriptive<span class="sc">$</span>emission, <span class="at">names.arg =</span>descriptive<span class="sc">$</span>year, <span class="at">main =</span> <span class="st">"Total amount of emission"</span>,<span class="at">col=</span><span class="st">"lightcyan"</span>,<span class="at">cex.names=</span><span class="fl">0.7</span>,)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span>bp, <span class="at">y=</span>descriptive<span class="sc">$</span>emission<span class="sc">*</span><span class="fl">0.9</span>,<span class="at">labels =</span> descriptive<span class="sc">$</span>emission,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">cex=</span><span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="assignment7_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>bp2 <span class="ot">&lt;-</span> <span class="fu">barplot</span>(descriptive<span class="sc">$</span>landfill, <span class="at">names.arg =</span>descriptive<span class="sc">$</span>year, <span class="at">main =</span> <span class="st">"Total amount of landfill"</span>,<span class="at">col=</span><span class="st">"lightcyan"</span>,<span class="at">cex.names=</span><span class="fl">0.7</span>,)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span>bp, <span class="at">y=</span>descriptive<span class="sc">$</span>landfill<span class="sc">*</span><span class="fl">0.9</span>,<span class="at">labels =</span> descriptive<span class="sc">$</span>landfill,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">cex=</span><span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="assignment7_files/figure-html/unnamed-chunk-1-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>bp3 <span class="ot">&lt;-</span> <span class="fu">barplot</span>(descriptive<span class="sc">$</span>transfer, <span class="at">names.arg =</span>descriptive<span class="sc">$</span>year, <span class="at">main =</span> <span class="st">"Total amount of transfer"</span>,<span class="at">col=</span><span class="st">"lightcyan"</span>,<span class="at">cex.names=</span><span class="fl">0.7</span>,)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span>bp, <span class="at">y=</span>descriptive<span class="sc">$</span>transfer<span class="sc">*</span><span class="fl">0.9</span>,<span class="at">labels =</span> descriptive<span class="sc">$</span>transfer,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">cex=</span><span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="assignment7_files/figure-html/unnamed-chunk-1-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>bp4 <span class="ot">&lt;-</span> <span class="fu">barplot</span>(descriptive<span class="sc">$</span>report_company, <span class="at">names.arg =</span>descriptive<span class="sc">$</span>year, <span class="at">main =</span> <span class="st">"The number of companies reporting"</span>,<span class="at">col=</span><span class="st">"lightcyan"</span>,<span class="at">cex.names=</span><span class="fl">0.7</span>,)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x=</span>bp, <span class="at">y=</span>descriptive<span class="sc">$</span>report_company<span class="sc">*</span><span class="fl">0.9</span>,<span class="at">labels =</span> descriptive<span class="sc">$</span>report_company,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">cex=</span><span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="assignment7_files/figure-html/unnamed-chunk-1-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(provincedata, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span>total_pollutants, <span class="at">fill =</span> province))<span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.5</span>, <span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start=</span><span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(total_pollutants<span class="sc">/</span><span class="dv">10079236016</span><span class="sc">*</span><span class="dv">100</span>,<span class="dv">1</span>),<span class="st">"%"</span>)),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"#ffffff"</span>)<span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span><span class="fu">c</span>(<span class="st">"#FF0000FF"</span>, <span class="st">"#FF9900FF"</span>, <span class="st">"#00FF00FF"</span>, <span class="st">"#6699FFFF"</span>, <span class="st">"#CC33FFFF"</span>, <span class="st">"#99991EFF"</span>, <span class="st">"#999999FF"</span>, <span class="st">"#FF00CCFF"</span>, <span class="st">"358000FF"</span>, <span class="st">"#0000CCFF"</span>, <span class="st">"#996600FF"</span>, <span class="st">"#666666FF"</span>, <span class="st">"#79CC3DFF"</span>, <span class="st">"#CCCC99FF"</span>, <span class="st">"#CC0000FF"</span>, <span class="st">"#CC99FFFF"</span>, <span class="st">"#FFCCCCFF"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="assignment7_files/figure-html/unnamed-chunk-1-6.png" class="img-fluid" width="672"></p>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>