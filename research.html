<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Research – Pyung Kim</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Pyung Kim</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">HOME</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./research.html" aria-current="page"> 
<span class="menu-text">RESEARCH</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./teaching.html"> 
<span class="menu-text">TEACHING</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./CV_Pyung Kim.pdf"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./photo.html"> 
<span class="menu-text">PHOTO</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#working-papers" id="toc-working-papers" class="nav-link active" data-scroll-target="#working-papers">Working Papers</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#under-review" id="toc-under-review" class="nav-link" data-scroll-target="#under-review">Under Review</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"></a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"></a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4"></a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5"></a></li>
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6"></a></li>
  <li><a href="#publications" id="toc-publications" class="nav-link" data-scroll-target="#publications">Publications</a></li>
  <li><a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7"></a></li>
  <li><a href="#section-8" id="toc-section-8" class="nav-link" data-scroll-target="#section-8"></a></li>
  <li><a href="#section-9" id="toc-section-9" class="nav-link" data-scroll-target="#section-9"></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Research</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="working-papers" class="level3">
<h3 class="anchored" data-anchor-id="working-papers">Working Papers</h3>
<ul>
<li><strong>Long-Term Effects of Neighborhoods on Educational Attainment by Disability Status</strong> (Dissertation)
<ul>
<li><p>Sole author</p></li>
<li><p>This study examines how the effects of neighborhoods on educational attainment differ by disability status, using administrative records from Texas on more than 1.2 million children from six kindergarten cohorts (1994-1999). Children whose families moved to higher-opportunity districts – as measured by the average outcomes of non-mover children across these cohorts – experienced higher probabilities of high school completion, college attendance, and college completion, with effects generally stronger for children with disabilities. The magnitude of these effects also varies by the timing of the move and by disability type. The study further shows that growing up in neighborhoods with a larger share of people with disabilities improves long-term educational attainment for children with disabilities themselves. These effects are stronger when the share of people with disabilities is measured among children rather than adults, underscoring the importance of peer environments and school-age disability networks. The findings highlight that educational opportunity is a deeply localized policy issue rather than a purely national or individual one, especially for children with disabilities.</p></li>
</ul></li>
</ul>
</section>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1"></h3>
</section>
<section id="under-review" class="level3">
<h3 class="anchored" data-anchor-id="under-review">Under Review</h3>
<ul>
<li><strong>From Command-and-Control to Carbon Pricing: Estimating the Causal Effects on Firm Environmental Performance</strong> <a href="http://dx.doi.org/10.2139/ssrn.5336846">(Available at SSRN)</a>
<ul>
<li><p>Sole author</p></li>
<li><p>This study evaluates the comparative effects of carbon pricing and command-and-control regulation on firm-level environmental performance. Leveraging South Korea’s unique dual-policy framework, I employ a difference-in-differences design using firm-level panel data from 2011 to 2022 to compare outcomes between firms regulated under a traditional command-and-control program (Target Management System, TMS) and those subject to a market-based carbon pricing mechanism (Emissions Trading Scheme, ETS). The results show that ETS-regulated firms reduced energy use by approximately 5.8% to 8.8% and carbon emissions by 7.3% to 8.5% across model specifications. However, the effects on carbon intensity were inconsistent and sensitive to model specifications. Event-study analyses suggest that these differing effects are driven by the heterogeneous timing of firm responses: immediate but short-lived reductions in energy use, persistent declines in carbon emissions, and gradual improvements in emissions efficiency. Phase-specific estimates further indicate that more market-oriented ETS phases were associated with stronger reductions in carbon emissions and intensity, underscoring the role of incentive-based policy design in enhancing environmental outcomes.</p></li>
</ul></li>
</ul>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2"></h3>
<ul>
<li><strong>Modeling Policy Diffusion Across Space and Time: A Bayesian Spatial</strong>-<strong>Temporal Approach</strong>
<ul>
<li><p>Corresponding author (with Hanvit Kim)</p></li>
<li><p>This study applies a Bayesian spatial-temporal model to demonstrate that policy diffusion is sensitive not only to spatial and temporal dependence but also to their interaction. Conventional event-history models typically treat these dimensions separately, which can misattribute correlated space-time shocks to substantive covariates and produce biased or spurious evidence of diffusion. Using a state-year panel of policy adoptions for the United States covering the period 1960 to 2017, we compare pooled logit, fixed-effects logit, and a sequence of Bayesian models that progressively incorporate spatial, temporal, and space-time components. Model fit improves substantially as each dependence structure is added, indicating that diffusion is shaped by localized state-year deviations as well as broader spatial and temporal processes, especially their interaction. The significance of many predictors shifts across specifications, underscoring the risks of ignoring spatial-temporal dependence. In contrast, ideological distance remains consistently significant, highlighting its role as a stable structural determinant of state policy diffusion.</p></li>
</ul></li>
</ul>
</section>
<section id="section-3" class="level3">
<h3 class="anchored" data-anchor-id="section-3"></h3>
<ul>
<li><strong>Individual and County-Level Factors Shaping Community Reintegration Among Burn Survivors: An Exploratory Machine Learning Approach</strong>
<ul>
<li><p>First author (with Kristine J. Hahm, Dohyeong Kim, Richard Scotch, and Karen Kowalske)</p></li>
<li><p>This study examines how individual and community factors shape community reintegration among adult burn survivors using a machine learning approach. Using Burn Model System data linked with county-level indicators from three major U.S. burn centers, we define reintegration as improvement in Community Integration Questionnaire (CIQ) scores and apply Extreme Gradient Boosting (XGBoost) to identify key predictors. The model highlights both clinical and contextual influences: age, burn severity, head burn involvement, and rehabilitation duration at the individual level, and high school graduation rates, juvenile arrest rates, civic association density, transportation cost burden, and poverty depth at the community level. Patients treated in Dallas show greater declines in CIQ scores than those in Seattle, partly reflecting less supportive community environments. Overall, the findings indicate that successful reintegration depends on both patient characteristics and structural conditions, underscoring the importance of incorporating place-based supports into post-acute care.</p></li>
</ul></li>
</ul>
</section>
<section id="section-4" class="level3">
<h3 class="anchored" data-anchor-id="section-4"></h3>
<ul>
<li><strong>mHealth Intervention Integrating Personal PM2.5 Monitoring and Deep Learning to Reduce Pediatric Asthma Exacerbations: A Pilot Study</strong>
<ul>
<li><p>First author (with Juyee Jung, Dohyeong Kim, Pranav Kumar, and Daejin Song)</p></li>
<li><p>Fine particulate matter (PM2.5) is a major trigger of pediatric asthma exacerbations, but children vary widely in their sensitivity. This pilot study tested an mHealth intervention that combined personal PM monitoring, deep learning-based prediction, and tailored behavioral recommendations. A total of 272 pediatric asthma patients were enrolled across nine hospitals in Korea, and a 1D CNN-LSTM model was developed using symptom reports and personal PM data. Of these, 109 children entered an intervention phase and were assigned to model-based, forecast-based, or no-intervention groups. The model-based group received individualized alerts generated from deep learning predictions, while the forecast-based group received alerts based on regional air quality forecasts. The model-based intervention significantly reduced exacerbation rates, showing a 6.6% median and 11.5% mean decrease, whereas the other groups showed no meaningful changes. Odds ratios indicated that the model-based group had substantially lower PM-related exacerbation risk than both comparison groups. These findings suggest that personalized, prediction-based mHealth support may help reduce PM-related asthma exacerbations in children and merits evaluation in larger studies.</p></li>
</ul></li>
</ul>
</section>
<section id="section-5" class="level3">
<h3 class="anchored" data-anchor-id="section-5"></h3>
</section>
<section id="section-6" class="level3">
<h3 class="anchored" data-anchor-id="section-6"></h3>
</section>
<section id="publications" class="level3">
<h3 class="anchored" data-anchor-id="publications">Publications</h3>
<ul>
<li><strong>Bayesian Spatio-Temporal Modeling for Policy Evaluation: Sensitivity of Policy Effect Estimates in the Context of COVID-19 Stay-at-Home Orders</strong> <a href="http://dx.doi.org/10.2139/ssrn.5337013">(<em>PLOS One</em>, Forthcoming. Available at SSRN)</a>
<ul>
<li><p>First author (with Sunghye Choi, Dohyeong Kim, and Chang-Kil Lee)</p></li>
<li><p>This study applies a Bayesian spatio-temporal model to demonstrate the sensitivity of policy effect estimates to spatial and temporal structure, using COVID-19 stay-at-home orders as a case study. Unlike conventional approaches, this framework accounts for geographic spillovers, temporal dependence, and space-time interaction, all of which are central to policy effect evaluation in heterogeneous settings. Implemented via Integrated Nested Laplace Approximation (INLA), the model also accommodates missing data and supports inference in high-dimensional contexts. Using Google mobility data and policy information from the Oxford COVID-19 Tracker, we estimate four models of increasing complexity: OLS, spatial, temporal, and spatio-temporal. While simpler models suggest substantial reductions in workplace and residential mobility, these effects become statistically insignificant once spatio-temporal interactions are incorporated. This pattern indicates that earlier studies may have overstated policy effects by overlooking spatio-temporal heterogeneity. Our findings demonstrate the importance of spatio-temporal modeling for policy evaluation, particularly when working with large-scale, incomplete, and unevenly distributed data.</p></li>
</ul></li>
</ul>
</section>
<section id="section-7" class="level3">
<h3 class="anchored" data-anchor-id="section-7"></h3>
<ul>
<li><p><strong>Geospatial Analysis of Community-Level Social and Environmental Barriers for Adult Burn Injury Survivors in North Texas</strong> <a href="https://doi.org/10.1016/j.burns.2025.107512">(2025, <em>Burns</em>, 51(5), 107512)</a></p>
<ul>
<li><p>First author (with Dohyeong Kim, Richard Scotch, Dohyo Jeong, and Karen Kowalske)</p></li>
<li><p>This preliminary study examines geographic differences in community integration among burn injury survivors in North Texas and identifies community factors that may shape their post-injury reintegration. Drawing on data from 153 adults in the Burn Model System between 2015 and 2022, we mapped county-level changes in Community Integration Questionnaire (CIQ) scores by comparing pre-injury levels with scores at six and twelve months. We then grouped counties based on whether survivors experienced consistent declines over the 12-month period and compared these counties to all others. Preliminary results reveal clear spatial disparities: counties with persistent decreases in CIQ scores tended to have higher poverty and unemployment, more crime, and poorer access to healthy food options. These patterns suggest that rural and disadvantaged communities may provide less supportive environments for reintegration. While exploratory, these findings indicate the importance of addressing local socioeconomic and environmental barriers to improve community integration outcomes for burn injury survivors.</p></li>
</ul></li>
</ul>
</section>
<section id="section-8" class="level3">
<h3 class="anchored" data-anchor-id="section-8"></h3>
<ul>
<li><p><strong>Have Offender Demographics Changed Since the COVID- 19 Pandemic? Evidence from Money Mules in South Korea</strong> <a href="https://doi.org/10.1016/j.jcrimjus.2024.102156">(2024, <em>Journal of Criminal Justice</em>, 91, 102156)</a></p>
<ul>
<li><p>Co-author (with Sunmin Hong and Dohyo Jeong)</p></li>
<li><p>This study aims to investigate how the demographic characteristics of offenders have changed after the COVID-19 pandemic. Specifically, our research focuses on shifts in the nationality, gender distribution, and age profiles of money mules during this period. We utilized arrest reports data provided by the Seoul Metropolitan Police Agency in South Korea, including all 1407 individuals arrested for money mules in Seoul from February 1, 2018, to December 31, 2021. Our findings, derived from interrupted time series analyses, show a decrease in the percentage of non-Korean money mules, an increase in the proportion of female individuals engaged in money mule activities, and a rise in the average age of money mules after the outbreak of the pandemic. These insights hold significant implications for developing targeted policy interventions to mitigate potential threats associated with money mule activities.</p></li>
</ul></li>
</ul>
</section>
<section id="section-9" class="level3">
<h3 class="anchored" data-anchor-id="section-9"></h3>
<ul>
<li><p><strong>Do Firms Respond Differently to the Carbon Pricing by Industrial Sector? How and Why? A Comparison Between Manufacturing and Electricity Generation Sectors Using Firm-Level Panel Data in Korea</strong> <a href="https://doi.org/10.1016/j.enpol.2021.112773">(2022, <em>Energy Policy</em>, 162, 112773)</a></p>
<ul>
<li><p>First author (with Hyunhoe Bae)</p></li>
<li><p>With firm-level panel data for seven years, this study evaluates the effect of carbon pricing policy and analyzes how firms respond to the carbon price, focusing on Korea’s Emission Trading Scheme (ETS). Assuming that firms’ responses to the carbon price may differ across industries, this study compares the manufacturing and electricity generation sectors. Our panel regression analyses show that the ETS has significant impacts on firms’ carbon reduction. However, the mechanisms through which firms reduce emissions differ by industrial sector. Firms in the manufacturing sector reduce carbon emissions by improving the energy efficiency of their facilities, whereas those in the electricity generation sector reduce emissions by phasing out fossil fuels and increasing the use of low carbon-intensive energy sources. These findings imply that carbon pricing works as designed, sending economic signals for firms to decarbonize their activities, and that its effectiveness varies according to each industry’s characteristics.</p></li>
</ul></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>